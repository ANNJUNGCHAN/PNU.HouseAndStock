# EDA
## 기초통계량
summary() 함수를 사용하여 4개의 변수에 대해 최소값, 1사분위수, 중앙값, 평균, 3사분위수, 최대값을 추출해내었다. 이 때, 국고채권 발행액의 경우 최대값이 아주 높게 나타나는 것을 볼 때, 특정 시점에 국고채권 발행액이 급격하게 증가하였다는 사실을 알 수 있다.

![image](https://user-images.githubusercontent.com/89781598/193569508-d355a22d-b5b4-4f9f-9343-7b16bc9732f6.png)

## 상관계수 파악
cor() 함수를 사용하여 4개의 변수에 대한 상관계수를 파악하였다.  이 때, 기준금리, 국고 채권 발행액은 전국 종합 주택 매매가격 지수는 굉장히 큰 상관관계를 보이고 있다. 또한, 기준금리와 국고채권 발행액도 굉장히 큰 상관관계를 보이고 있다는 사실을 알 수 있다.

![image](https://user-images.githubusercontent.com/89781598/193569590-ebadcfc9-ecbd-4a3d-99b0-3a71cfc8471d.png)

## 산점도 행렬 그리기
이 때, 산점도 행렬을 그리면 아래와 같다. 기준금리. 국고채권의 발행액, 화폐발행 잔액에 대한 전국 주택 종합 매매가격 지수를 보여주며, 전국 주택 종합 매매가격 지수는 기준금리와는 음의 상관관계를, 국고 채권 발행액과는 양의 상관관계를 가짐을 알 수 있다. 또한, 기준금리와 국고채권 발행액간의 음의 상관관계가 어느 정도 있다고 할 수 있다. 전국 주택 종합 매매가격 지수와 화폐발행 잔액 사이에는 뚜렸한 상관관계까 보이지 않는다.

![image](https://user-images.githubusercontent.com/89781598/193569651-82d11dba-7785-436f-adcd-f44485e50e91.png)

# 선형 회귀모형에 적합

## 최소제곱 추정값
세 개의 설명변수에 대해서 기준금리를 X1, 국고채권의 발행액을 X2, 화폐발행 잔액을 X3라 놓은 후 전국 주택 종합 매매가격 지수를 Y라고 놓은 후 다중 선형회귀 모형을 만들 것이다. 이 때, 다중 선형 회귀식은 아래와 같다고 알려져 있다.

![image](https://user-images.githubusercontent.com/89781598/193569754-3c0206a8-ee88-4cd7-934e-530f70b9b8c2.png)

이 때, summary()함수를 이용하면, 제안된 회귀식에 있는 각 계수의 최소제곱 추정치 값을 구하면, 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193569791-1c96007f-f568-464a-b0fe-51df5dc6205a.png)

추정된 회귀식은 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193569832-d426f17f-2b4f-48ba-8b10-d4ddf80d7b98.png)

이 때, *σ*2의 추정값 *s*2은 Residual standard error=7.337의 제곱인 53.831569로 주어짐을 쉽게 알 수 있다. 이 때, 잔차제곱합의 자유도는 208이라는 사실 또한 알 수 있다.

또한, summary()함수를 이용하면 **각 회귀계수에 대한 추정**도 진행할 수 있는데, 이는 Coefficients: 맨 오른쪽에 주어지는 t-통계량과 p-값을 이용하여 쉽게 구할 수 있다.

유의수준 *α* = 0.05로 검정할 때 우선, 자유도가 17인 t-분포표의 값을 구하면 qt(0.95,17)을 이용하여 1.652212이라는 사실을 알 수 있고, *β*0의 t통계량의 절대값은 34.874, *β*1의 t통계량의 절대값은 10.048, *β*2의 t통계량의 절대값은 2.985, *β*3의 t통계량의 절대값은 1.306으로, *β*3를 제외하면 모두 귀무가설 *H*0 : *βi* = 0(*i* = 0, 1, 2, 3)를 기각하게 된다. 이 때, *β*3는 기각하지 못하게 된다.

즉, 기준금리와 국고채권의 발행액의 회귀계수 추정값은 통계적으로 모두 유의하며, 화폐발행 잔액의 경우는 유의하지 않으나 통계량의 값이 경계선 근처에 있어 어느 정도의 관계는 보이고 있다.
이 때, 상수항의 유의성은 관심의 대상이 아니므로, 일반적으로 유의성 여부에 관계없이 모형에 포함시킨다.

회귀계수에 대한 신뢰구간은 confint()함수를 통해서 쉽게 구해진다.

![image](https://user-images.githubusercontent.com/89781598/193569886-5f06ff2d-b5e1-4fcf-ba7c-e7e971ff9024.png)

이 때, 추정된 회귀식을 이용한 예측값은 fitted()함수를 이용하여 아래와 같이 구해지고,

![image](https://user-images.githubusercontent.com/89781598/193569948-1ea7d166-8179-4af3-8d17-63b03c0b520c.png)
![image](https://user-images.githubusercontent.com/89781598/193569988-245792ee-95ec-48e0-8701-d31263aec421.png)

그에 따른 잔차는 resid()함수를 이용하여 아래와 같이 구해진다.

![image](https://user-images.githubusercontent.com/89781598/193570054-6bbb50c9-6e9b-42a0-9a5a-8628447837bf.png)
![image](https://user-images.githubusercontent.com/89781598/193570099-25abd6c2-4499-4b5f-8a09-4f71dc6de756.png)

## 공동신뢰영역과 가설검정
앞 전에서는 한 개의 모수에 대해서만 t검정을 실시하였다면, 두 개 이상의 모수에 대해 t검정을 동시에 수행하는 경우 유의수준 해석에 주의하여야하는데, 이 때 두 개 이상의 모수에 대해 t-검정을 실시하는 방법이 바로 공동신뢰영역을 구하는 것이다.

공동신뢰 영역은 ellipse 패키지를 이용하여 타원을 손쉽게 그려서 문제를 해결할 수 있는데, 그 결과는 아래와 같이 주어진다.

![image](https://user-images.githubusercontent.com/89781598/193570153-c8c82df7-0eba-4933-bf24-0a1295f812a8.png)

이 때, 각 회귀계수에 대한 신뢰구간은 점선으로 표시되어 있는데, 이들 신뢰구간에 의해 주어지는 사각형의 영역은 공동신뢰영역에 속하지 않는 점들을 많이 포함하고 있어 상당히 부정확하다고 할 수 있다. 회귀계수가 3개 이상인 경우에는 공동신뢰영역이 3차원 이상이 되므로 영역의 구현이 어렵기에, 2개가 적당하다.

## 적합도와 분산분석
우선, 분산분석 표를 작성하고 F 검정을 실시한다. 분산분석표는 anova()를 통해 구해지고, 그 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193570249-d84c972c-2fd1-47ae-aee9-e0dc5e336b06.png)

이 때, SSE의 값에 대한 정보는 residuals에 나타나 있고, 자유도는 208, SSE의 값은 11198라는 사실을 안다. 또한, MSE값은 53.8이다.
SSR은 3개의 설명변수에 의해 순차적으로 제시되어 있는데, X1에 대한 변동은 17082, X2에 대한 변동은 470.8, X3에 대한 변동은 91.9이라는 사실을 알 수 있다. 이 모든 변동을 더한 것이 SSR이므로, SSR=17644.7이라는 사실을 알 수 있다. SST=SSR+SSE=28842.7이라는 사실은 자명하다.

이 때의 F값은 각 설명변수가 모형에 순차적으로 포함될 때 유의성 검정에 사용된다. p값이 유의수준 0.05보다 작을 때 각 단계에서 설명변수들이 추가될 때 설명되는 변동의 크기가 유의하다는 것을 알 수 있다. 즉, X3를 제외하면 설명되는 변동의 크기가 모두 유의하다.

분산분석표에서 주어지는 회귀계수 전체가 0이라는 가설 *H*0 = *β*1 = *β*2 = ... = *βp* − 1 = 0에 대한 결과는 summary()함수에 의해서 알 수 있는데. 이 때 검정 결과를 보면, 자유도 3과 17에 해당하는 F-통계량이 109.2이으로, 그에 해당하는 p값은 < 2.2e-16로 주어져 있다. 이 때, 유의수준 *α* = 0.05에 해당하는 정확한 분위수를 qf(0.95,3,17)로 구하면 2.64801이 나오는데, 이 값보다 통계량이 월등히 크므로 귀무가설이 기각되고, p값이 0.05보다 월등히 작으므로 마찬가지로 귀무가설이 기각되어, **주어진 설명변수들 중에는 전국 종합 주택매매가격지수를 설명하는데 유용한 변수가 될 수 있다는 것을 입증해준다.**
또한, summary함수에서, *R*2=0.6118로 어느정도 높은 편이고, 수정 *R*2=0.6062이다.
*R*2는 전체변동 중 적합된 회귀식에 의해 설명되는 비율을 나타내므로 설명량이 어느정도 높은 편이다.

## 잔차분석
R에서 lm객체에 plot()을 적용하여 회귀진단을 위한 그래프를 그리면, 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193570403-c43dffb9-8d21-45ec-b830-50dbb492234c.png)

상단 왼쪽에 있는 잔차 대 예측값 산점도에서는 13,14,15번 개체가 크게 벗어난 이상치로 판단된다. 하단 왼쪽에 있는 표준화잔차의 절대값의 제곱근 대 예측값의 산점도를 보면 13, 14, 15번 관측치가 이상치로 판단된다. 상단 오른쪽에 있는 표준화잔차의 정규확률도를 보면, 정규성은 어느 정도 만족된다고 할 수 있으나, 마찬가지로 13, 14, 15번 관측치가 이상치로 판단된다. 마지막으로 하단 오른쪽에 있는 표준화잔차 대 지렛값 그림에서는 58, 59, 16번 관측치가 이상치로 판단되는 것으로 보인다.

다음으로, 표준화 잔차 대 설명변수들의 산점도를 그리면, 그 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193570449-6c2229a1-0a19-4b5d-9e4d-098a3d762178.png)

특이한 경향이 없으므로, 설명변수들의 제곱항 등을 추가할 필요는 없다고 판단된다.

관측값 대 예측값 산점도와 RF 그림을 그리면, 아래와 같이 구할 수 있고,

![image](https://user-images.githubusercontent.com/89781598/193570503-6ca34209-47eb-4d92-a766-4dde0e3fc845.png)

이 때, 관측값 대 예측값 산점도에서 두 값이 일치하는 정도가 높아서 현재모형의 적합도가 높다고 볼 수 있으며, RF(Residaul-Fit)그림에서는 자료가 갖는 총 변동 중에서 적합된 회귀식이 설명하고 있는 변동이 잔차에 남아있는 변동보다 훨신 크다는 것을 보여주고 있다.

## 부분 F검정
우선, 부분 F검정을 수행하기 위해서는 설명변수 3개를 모두 표함하는 회귀모형에 대한 분석에서 회귀제곱합 SSR을 각 회귀계수에 대한 추가제곱합으로 분해시켜야 한다.

모형을 적합하여 lm객체를 만든 후, anova()함수를 적용하여 설명변수가 모형에 포함되는 순서대로 SSR이 증가하는 정도인 순차제곱합을 구하면, 그 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193570560-81e9bbd7-c2bb-4dfd-b28a-45beee189bf9.png)

이 때, 순차제곱합의 경우, 아래의 식을 만족한다고 할 수 있다.

![image](https://user-images.githubusercontent.com/89781598/193570617-ccbc497d-fb33-47a9-9282-9e5b7de19a96.png)

이 때, 순차제곱합들은 각각 1의 자유도를 가지므로, 평균제곱도 제곱합과 동일하게 주어진다는 것을 알 수 있고, 위의 ANOVA table에서 오른편에는 각 평균제곱들의 크기에 대한 F 검정 결과가 주어져있다.

이 때, 편 제곱합은 drop1()함수를 이용하여 구할 수 있고, test 인자에서 F 검정을 지정해주면, F값과 p값이 출력된다. 그 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193570666-3e5eda0e-3db3-4c68-a752-e9f137947377.png)

이 결과는 편제곱합으로 설명변수가 3개 있는 완전모형에서 해당 설명변수를 제외할 때 감소하는 SSR의 크기, 또는 증가하는 SSE의 크기이다.

즉, 아래와 같음을 의미한다.

![image](https://user-images.githubusercontent.com/89781598/193570711-ddd49b19-02d1-44de-b1d9-35454878a2bf.png)

이 때, SSE(F)=11198로 주어져있고, SSR(R)는 X!,X2,X3 각각 16633 , 11678, 11290으로 주어져 있다는 사실을 알 수 있으며, sum of sq 부분에 편 제곱합이 나타나있는 것을 확인할 수 있다.
또한, 오른쪽을 보면 편 제곱합에 대한 F 검정통계량과 P값이 주어져있음을 알 수 있는데, 이 때, X3의 회귀계수에 대한 p-값이 0.192911으로 귀무가설 을 기각할 수 없게된다.

## 적합결여검정
이 때, SSE(F)=11198로 주어져있고, SSR(R)는 X!,X2,X3 각각 16633 , 11678, 11290으로 주어져 있다는 사실을 알 수 있으며, sum of sq 부분에 편 제곱합이 나타나있는 것을 확인할 수 있다.
또한, 오른쪽을 보면 편 제곱합에 대한 F 검정통계량과 P값이 주어져있음을 알 수 있는데, 이 때, X3의 회귀계수에 대한 p-값이 0.192911으로 귀무가설 을 기각할 수 없게된다.

![image](https://user-images.githubusercontent.com/89781598/193570785-ee3729fc-a711-49b5-85ce-13d657056619.png)

위의 출력결과에서 오차제곱합 SSE=11198는 순 오차제곱합=0과 적합결여제곱합=11198으로 분해된 것을 확인할 수 있다. 이 때, F의 비가 1보다 매우 커서 표시되지 않고있는데, 적합이 매우 결여되었다는 것을 알 수 있다. 즉, 적합결여제곱이 순오차 평균 제곱보다 크다는 의미가 된다. 즉, 모형을 수정해서 적합시켜야 된다는 것을 내포한다.

# 회귀진단

## 잔차와 지렛값을 이용한 분석
내표준화잔차와 외표준화잔차, 지렛값은 각각 rstandard(), rstudent(), hatvalues()를 이용하여 구할 수 있다.

이 때, 내표준화 잔차와 외 표준화 잔차에 대한 기준값을 절댓값 2로 놓고, 지렛값에서는 지렛값 기준치 2p/n=8/212=0.037735로써 관측치들을 보았을 때, 이에 반하는 값들은 각각 아래의 표와 같다.

![image](https://user-images.githubusercontent.com/89781598/193570984-a3c84020-2784-4a96-9d38-b7af3d2947b9.png)

또한, 이 값들을 사용하여 SSE와 PRESS를 구할 수 있는데, R에 수식을 써서 이 값들을 구하면, SSE=11197.97, PRESS=11577.81이므로, PRESS의 값이 더 커서 관측치들중에 이상치가 존재할 가능성을 시사해주고 있다.

## 영향력 측도
여러 가지 영향력 측도는 influence.measures()로 구할 수 있다.

이 때, 앞의 4열은 상수항을 포함한 회귀계수 4개의 각각에 대한 DFBETAS의 값을 보여주고, 다음으로 DFFITS, COVARATIO, 쿡의 거리, 지렛값들이 주어져있다.

이때 각각의 기준값은 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571063-673fc142-efe9-4aeb-a6e6-cbfefc8d0a28.png)

이 때, 기준에 맞춰서 이상치들을 구해보도록 한다. 하지만, 이 때 이상치의 기준이 너무 많기 때문에, influence.measures()함수 내의 기능을 이용하여 이상치를 계산해본다. 이 때, print(), which(), apply() 함수를 이용하여 측도 1개 이상에서 이상치라고 판단되는 경우, 측도 2개 이상에서 이상치라고 판단되는 경우, 측도 3개 이상하여 이상치라고 판단되는 경우를 각각 구해본다.

이 때, COVRATIO의 경우, 이상치일 때, $\hat{\beta}$의 분산-공분산 행렬인 $cov(\hat{\beta})$의 추정값에 영향을 주는 관측치이고, DFFIT의 경우 이상치일 때, 관측치가 적합값 $\hat{y_i}$에 대한 영향력을 준다고 볼 수 있다. DFBETAS의 경우, 이상치일 때, x1, x2, x3간의 계수에 영향력을 준다고 할 수 있다. 이 때, 이상치라고 판단되는 값들은 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571114-8a99330d-35b0-4d70-b7ae-fd878e02665f.png)

이 때, 쿡의 거리와 DFFFITS에 대해서는 그림으로도 이상치를 판단할 수 있다.

![image](https://user-images.githubusercontent.com/89781598/193571169-66365005-79c0-4632-853f-3ffc3683b478.png)

왼쪽의 그래프는 각 개체에 대한 쿡의 거리값을 나타낸다. 완전모형으로 구한 예측값 $\hat{Y(i)}$ 와의 차이에 근거한 통계량으로, 이 값이 클수록 I번째 관측치는 이상점 혹은 영향점일 가능성이 높다. 기준 값 0.017, 즉 0.02 이상이면 이상점으로 판단될 수 있으며, 16, 58, 59번째 관측값은 다른 관측값보다 쿡의 거리가 크다.

오른쪽에 있는 그래프에서 각 개체 I에 대한 DFFITS를 보면 $\hat{Y(i)}$는 I번째 관측을 제외한 회귀모형에 의해 예측한 I번째 예측값으로 완전모형의 $\hat{Y(i)}$와 차이가 크다면 영향점 혹은 이상점일 가능성이 높다. 이 때, DFFITS가 0.27을 벗어나면 이상점일 가능성이 높은데, 마찬가지로 16, 58, 59번째 관측치에서 다른 관측치보다 절댓값이 크다는 사실을 알 수 있으므로, 16, 58, 59번째 관측치를 유심히 관측해 볼 필요가 있다는 것을 안다.

이후 쿡의 거리 대 지렛대점 그래프와 스튜던트화 잔차 대 모자행렬 그래프를 통해 영향점을 파악한다.

![image](https://user-images.githubusercontent.com/89781598/193571247-9dc6850f-fed5-4604-9290-2068f9ddb8b2.png)

왼쪽 그림은 모자행렬의 대각원소인 $h_{ii}$의 지렛대 기울기와 영향점을 나타낸다. $h_{ii}$의 값이 크면 클수록 그 관측값은 최소제곱선상에서 더 많은 영향을 미친다. 관측값 $Y_i$가 일반적으로 지렛대점에 상응되어 나타나면 좋은 지렛대점이라고 한다. 그러나, $Y_i$가 다른 관측값들에 비해 떨어져 있으며 이상점과 대응되어 나타나면 나쁜 지렛대점이라고 한다. 이 때, 16, 58, 59번 관측치가 최소제곱선에서 멀리 떨어져 있고, 다른 관측값에 비해서 데이터 추세에 벗어나 있으므로, 이 점은 나쁜 지렛대 점이라 할 수 있어 원 데이터에서 제거할 수 있다.

오른쪽 그림은 모자행렬에 대한 스튜던트화 잔차의 영향점 그림으로 지렛대 값에 대한 스튜던트화 잔차와 더불어 쿡의 거리를 원의 크기로 표시한 잔차 그림이다. 원의 크기를 보면, 14, 15, 58, 59, 208, 212번째 관측값에 대한 쿡의 거리값이 가장 크다. 즉, 쿡의 거리가 크면 이상치일 가능성이 있다는 의미이다.

## 결론
모든 측도들을 종합하면 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571312-53dd3a38-d9f9-4d25-aab2-9e6543522ffc.png)

이 때, 위의 측도들에서 2번 이상 이상치라고 판정 받은 관측치들만 제외시킨다. 이 값은 4, 11, 12, 13, 14, 15, 16, 18, 19, 58, 59, 155, 158, 168, 191, 194, 195, 197, 198, 200, 203, 204, 205, 208, 209, 210, 211, 212이다.

# 회귀모형 선택

## 회귀 모형의 선택
우선, 앞서 했던 모든 검정을 통해서, 이상치에 해당하는 관찰값을 제외하고 회귀 모형을 선택하는 과정을 따른다.

이 때, 모형을 선택하는 기준에는 7개의 변수선택 기준을 사용할 것이다. 이는, R-squared, Adj R-squared,$S^2_p$,$C_p$,$PRESS_p$, AIC, BIC이다. 우선 결정계수, 수정된 결정계수, 멜로우즈 , $C_p$,BIC는 regbook 패키지에서 제공하는 summaryf() 함수를 사용하면 쉽게 구할 수 있는데, 그 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571516-338a7973-dc8c-4cf9-9447-179929f6771b.png)

또한, AIC와 $S^2_p$는 olsrr 패키지의 ols_aic(), ols_msep()를 쓰면 쉽게 구할 수 있는데 그 결과는 아래에 있다.

![image](https://user-images.githubusercontent.com/89781598/193571575-cbc98883-d828-4f23-b9e9-c4173eebae10.png)

$PRESS_p$는 regbook 패키지의 press()를 적용하면 각 모형에 대한 $PRESS_p$를 계산해준다.

![image](https://user-images.githubusercontent.com/89781598/193571653-87db5d6f-c6b0-4c45-adba-419f0d5715f7.png)

이 때, 구한 값들을 가지고 회귀모형을 선택한다.

## 결정계수
우선, 결정계수에서는 모든 가능한 모형에서 결정계수를 전부 계산한 다음, p가 증가해도 결정계수의 증가폭이 그다지 크지 않은 시점에서 선택하는 것이 바람직하다. 위의 값을 사용하여 그림을 그려보면 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571718-e41e18ce-f692-4b1a-a2c2-998aab1801bc.png)

이 때, p가 증가해도 결정계수의 증가폭이 그다지 크지 않은 시점은 X1,X2일 때 이므로, 결정계수에 근거한 최적모형은 X1,X2만 포함한 모형이라고 할 수 있다.

## 수정된 결정계수
수정된 결정계수에서는 그 값이 최대가 되는 모형을 최적모형으로 선택해야 한다. 위의 값을 사용하여 그림을 그려보면 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571795-5efe619b-69a4-42c1-b7e3-ed4b5315946b.png)

이 때, 수정된 결정계수 값이 최대가 되는 모형은 X1,X2일 때, 즉 0.5960일 때 이므로, 결정계수에 근거한 최적모형은 X1,X2만 포함한 모형이라고 할 수 있다.

## $S^2_p$
$S^2_p$에서는 그 값이 최소가 되는 모형을 최적모형으로 선택해야 한다. 그 이유는 수정된 결정계수와 상관이 있는데, 수정된 결정계수의 식을 보면 아래와 같다..

![image](https://user-images.githubusercontent.com/89781598/193571881-e48111f1-df1f-43cf-b191-227219e626a0.png)

이 때, 수정된 결정계수가 최대가 되는 값은 $S^2_p$가 최소가 되는 값과 같다는 것을 파악할 수 있다.

위의 값을 사용하여 그림을 그려보면 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571931-b9db1dcf-7023-4c3a-b86b-e3c98b327494.png)

이 때, 수정된 결정계수 값이 최소가 되는 모형은 X1,X2일 때, 즉 8253.521일 때 이므로, 결정계수에 근거한 최적모형은 X1,X2만 포함한 모형이라고 할 수 있다.

## $C_p$

$C_p$에서는 car패키지의 subsets()함수를 이용해 Cp plot을 그릴 수 있고, x축이 예측 인자의 수, y축이 cp통계량으로 절편이 1, 기울기가 1인 직선이 빨간 점선으로 표시되어 있다. 이 점선에 가까운 모형이 좋은 모형이다. 이러한 방식으로 찾는 것이 가능하다.

또 하나의 방법은 $C_p <= 2p-3$ (최대모형에 있는 설명 변수의 갯수)로 판단 가능하다.

위의 값을 사용하여 그림을 그려보면 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193571992-41574416-4597-45e7-aec4-0fe2669836d0.png)

우선, 기울기 1, 절편 1인 빨간 직선에 가까워 보이는 점은 총 4개이다. 바로 X1, (X1,X2) , (X1,X3), (X1,X2,X3)이다. 이 때, 아래의 기준 $C_p <= 2p-3$ (최대모형에 있는 설명 변수의 갯수) 을 사용하면, X1에서 3보다 작지 않으므로 탈락, (X1,X2) 3보다 작으므로 적합한 모형이며, 에서 , (X1,X3)는 3보다 크므로 적합하지 않고, (X1,X2,X3)에서는 5보다 작으므로 적합하다. 그러므로 $C_p$를 이용하면 적합한 모형이 (X1,X2)일때와 (X1,X2,X3)로 두 개가 찾아진다.

## $PRESS_p$
$PRESS_p$에서는 그 값이 최소가 되는 모형을 최적모형으로 선택해야 한다. 위의 값을 사용하여 그림을 그려보면 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193572087-d899ccbf-d1af-4ddc-aa91-fef3b60eb4bc.png)

이 때, 수정된 결정계수 값이 최소가 되는 모형은 X1,X2일 때, 즉 8407.069일 때 이므로, 에 근거한 최적모형은 X1,X2만 포함한 모형이라고 할 수 있다.

## AIC, BIC
AIC는 다음과 같이 정의된다

![image](https://user-images.githubusercontent.com/89781598/193572143-8cd5d496-d5ba-4bcc-a559-101c18f5af26.png)

이 때, 통계학에서 모수추정방법으로 가장 많이 사용되는 최대우도추정법은 위의 우도함수 ($L(\theta)$)를 최대화 하는 모수 $\theta$의 값 $\hat{\theta}$를 구하는 방법이다. 즉, 이 때, $L(\hat{\theta})$는 우도함수의 최대값이 되고, 그 말 뜻은 AIC가 최소값이 될 때 가장 좋은 모형이라는 것이다.

BIC는 다음과 같이 정의된다.

![image](https://user-images.githubusercontent.com/89781598/193572232-cbdfc0e5-7afa-4a0a-bb8e-73abd1de0b73.png)

![image](https://user-images.githubusercontent.com/89781598/193572256-6e77a11c-f1fc-4956-ba25-b89edfeee796.png)

이 때에도 BIC가 최소값이 될 때 가장 좋은 모형이라는 뜻이다.
최소값을 찾으면, AIC, BIC 모두 (X1, X2)에서 최솟값을 갖는다는 사실을 확인할 수 있다.



