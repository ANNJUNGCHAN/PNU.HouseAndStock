# EDA
## 산점도 행렬 그리기
데이터의 특성을 파악하기 위해서 산점도 행렬을 그려보았다. 그 결과는 아래의 그림에 나와있다.

![image](https://user-images.githubusercontent.com/89781598/193573149-672a1bdb-40b5-4025-b083-31d45c7e5ef4.png)

<그림 1>에서는 기준금리. 국고채권의 발행액, 화폐발행 잔액에 대한 코스피 지수를 보여주며, 코스피 지수는 기준금리와는 음의 상관관계를, 국고 채권 발행액과는 양의 상관관계를 가짐을 알 수 있다. 또한, 기준금리와 국고채권 발행액간의 음의 상관관계가 어느 정도 있다고 할 수 있다. 전국 주택 종합 매매가격 지수와 화폐발행 잔액 사이에는 뚜렸한 상관관계까 보이지 않는다.

# 선형 회귀모형에 적합
## 최소제곱 추정값
이번엔 세 개의 설명변수에 대해서 기준금리를 X1, 국고채권의 발행액을 X2, 화폐발행 잔액을 X3라 놓은 후 코스피 지수를 Y라고 놓은 후 이전의 절차대로 다중 선형회귀 모형을 만들 것이다.

이 때, 제안된 회귀식에 있는 각 계수의 최소제곱 추정치 값을 구하면, 결과는 아래와 같다

![image](https://user-images.githubusercontent.com/89781598/193573303-943bb2a8-8490-4eeb-a6c4-f99fdd329a5b.png)

추정된 회귀식은 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193573347-29679fb6-b4a4-4205-8368-4705250952bd.png)

이 때, *σ*2의 추정값 *s*2은 Residual standard error=367.5의 제곱인 135056.25로 주어짐을 쉽게 알 수 있다. 이 때, 잔차제곱합의 자유도는 208이라는 사실 또한 알 수 있다.

또한, summary()함수를 이용하면 **각 회귀계수에 대한 추정**도 진행할 수 있는데, 이는 Coefficients: 맨 오른쪽에 주어지는 t-통계량과 p-값을 이용하여 쉽게 구할 수 있다.

또한, **각 회귀계수에 대한 추정**도 진행하면,  $\beta_3$를 제외하면 모두 귀무가설  $H_0 : \beta_i =0(i=1,2,3)$를 기각하게 된다. 이 때,  $\beta_3$는 기각하지 못하게 된다.

즉, 기준금리와 국고채권의 발행액의 회귀계수 추정값은 통계적으로 모두 유의하며, 화폐발행 잔액의 경우는 유의하지 않으나 통계량의 값이 경계선 근처에 있어 어느 정도의 관계는 보이고 있다.

## 공동신뢰영역과 가설검정
방식은 이전의 방식과 동일하며, 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193573441-6d748809-322d-4836-9c2c-79bd80a454dd.png)

이 때, 각 회귀계수에 대한 신뢰구간은 점선으로 표시되어 있는데, 이들 신뢰구간에 의해 주어지는 사각형의 영역은 공동신뢰영역에 속하지 않는 점들을 많이 포함하고 있어 상당히 부정확하다고 할 수 있다.

## 적합도와 분산분석
우선, 분산분석 표를 작성하고 F 검정을 실시한다. 분산분석표는 anova()를 통해 구해지고, 그 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193573537-dccfbf5f-6d15-4879-b490-9672d19ecc31.png)

이 때, 자유도는 208, SSE의 값은 28086641라는 사실을 안다. 또한, MSE값은 135032이다.
SSR=23190683이고 SST=SSR+SSE=51277324이다.

이 때의 F값에서, X3를 제외하면 설명되는 변동의 크기가 모두 유의하다.

분산분석표에서 주어지는 회귀계수 전체가 0이라는 가설 *H*0 = *β*1 = *β*2 = ... = *βp* − 1 = 0에 대한 결과는 유의수준 $\alpha=0.05$에 해당하는 정확한 분위수를 qf(0.95,3,17)로 구하면 2.64801이 나오는데, 이를 비교해보면, 주어진 설명변수들 중에는 코스피 지수를 설명하는데 유용한 변수가 될 수 있다는 것을 입증해준다.

또한, summary함수에서 $R^2=0.4525$로 어느정도 높은 편이고, 수정 $R^2=0.4444$이다.

$R^2$은 전체변동 중 적합한 회귀식에 의해 설명되는 비율을 나타내므로 설명량이 어느정도 있지만, 개선의 여지가 필요하다.

## 잔차분석
R에서 lm객체에 plot()을 적용하여 회귀진단을 위한 그래프를 그리면, 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193573619-6d6b0cdd-2270-4c72-a6eb-b565b0229c9a.png)

상단 왼쪽에 있는 잔차 대 예측값 산점도에서는 9, 11, 15번 개체가 크게 벗어난 이상치로 판단된다. 하단 왼쪽에 있는 표준화잔차의 절대값의 제곱근 대 예측값의 산점도를 보면 9,11,15번 관측치가 이상치로 판단된다. 상단 오른쪽에 있는 표준화잔차의 정규확률도를 보면, 정규성은 어느 정도 만족된다고 할 수 있으나, 마찬가지로 9, 11, 15번 관측치가 이상치로 판단된다. 마지막으로 하단 오른쪽에 있는 표준화잔차 대 지렛값 그림에서는 197, 198, 200번 관측치가 이상치로 판단되는 것으로 보인다.

다음으로, 표준화 잔차 대 설명변수들의 산점도를 그리면, 그 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193573670-e516d8f9-0aa3-4681-9049-3ab18f1362ef.png)

특이한 경향이 없으므로, 설명변수들의 제곱항 등을 추가할 필요는 없다고 판단된다.
관측값 대 예측값 산점도와 RF 그림을 그리면, 아래와 같이 구할 수 있고,

![image](https://user-images.githubusercontent.com/89781598/193573733-bf93dc51-9210-4de6-a0e8-6eeab4000cca.png)

이 때, 관측값 대 예측값 산점도에서 두 값이 일치하는 정도가 높아서 현재모형의 적합도가 높다고 볼 수 있으며, RF(Residaul-Fit)그림에서는 자료가 갖는 총 변동 중에서 적합된 회귀식이 설명하고 있는 변동이 잔차에 남아있는 변동보다 훨신 크다는 것을 보여주고 있다.

## 부분 F검정
이 과정도 마찬가지로 앞을 따른다.

![image](https://user-images.githubusercontent.com/89781598/193573824-5878dd66-d54f-47a1-af00-88fe5724d326.png)

이 때, 순차제곱합의 경우, 아래의 식을 만족한다고 할 수 있다.

![image](https://user-images.githubusercontent.com/89781598/193573897-94b050a3-25b0-4cf4-9713-3945cd7302c5.png)

이 때, 순차제곱합들은 각각 1의 자유도를 가지므로, 평균제곱도 제곱합과 동일하게 주어진다는 것을 알 수 있고, 위의 ANOVA table에서 오른편에는 각 평균제곱들의 크기에 대한 F 검정 결과가 주어져있다.
이 때, 편 제곱합은 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193573957-fe01ff52-e7d4-4e1b-9804-b89fb9086fa7.png)

SSE(F)=28086641로 주어져있고, SSR(R)는 X1,X2,X3 각각 31812270 , 30647168, 28351949으로 주어져 있다는 사실을 알 수 있으며, sum of sq 부분에 편 제곱합이 나타나있는 것을 확인할 수 있다. 이는 아래의 식을 통해서 유도가능하다.

![image](https://user-images.githubusercontent.com/89781598/193573996-a9d316a8-83d8-4925-afa2-25d7e3cc5574.png)

또한, 오른쪽을 보면 편 제곱합에 대한 F 검정통계량과 P값이 주어져있음을 알 수 있는데, 이 때, X3의 회귀계수에 대한 p-값이 0.1625으로 귀무가설 $H_0 : \beta_3 = 0$을 기각할 수 없게 된다.

## 적합결여검정
절차는 앞과 같으며, 이에 대한 결과는 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193574080-31f97199-be59-4ecb-941f-426c75019da6.png)

위의 출력결과에서 오차제곱합 SSE=28086641는 순 오차제곱합=0과 적합결여제곱합=28086641으로 분해된 것을 확인할 수 있다. 이 때, F의 비가 1보다 매우 커서 표시되지 않고있는데, 적합이 매우 결여되었다는 것을 알 수 있다. 즉, 적합결여제곱이 순오차 평균 제곱보다 크다는 의미가 된다. 즉, 모형을 수정해서 적합시켜야 된다는 것을 내포한다.

# 회귀진단
## 잔차와 지렛값을 이용한 분석
절차는 앞과 같다.
이 때, 내표준화 잔차와 외 표준화 잔차에 대한 기준값을 절댓값 2로 놓고, 지렛값에서는 지렛값 기준치 2p/n=8/212=0.037735로써 관측치들을 보았을 때, 이에 반하는 값들은 각각 아래의 표와 같다.

![image](https://user-images.githubusercontent.com/89781598/193574245-2529d689-f0c3-4948-a732-3a969102698d.png)

이 때, SSE=28086641, PRESS=29371687이므로, PRESS의 값이 더 커서 관측치들중에 이상치가 존재할 가능성을 시사해주고 있다.

## 영향력 측도
방법은 앞과 같이 시행한다.

![image](https://user-images.githubusercontent.com/89781598/193574317-c32ed547-a87c-4834-9ba4-7f0cf92ba6bc.png)

이 때, 쿡의 거리와 DFFFITS에 대해서는 그림으로도 이상치를 판단할 수 있다.

![image](https://user-images.githubusercontent.com/89781598/193574360-cf152ec7-6c3b-4e57-a808-77e552fa4b80.png)

이 때, 197, 198, 200번째 관측값은 다른 관측값보다 쿡의 거리가 크다. 하지만, DFFITS에서는 크게 벗어난다는 신호는 없지만, 이상치로 보이는 값이 몰려있는 곳이 197, 198, 200번째 관측값이라는 것을 짐작해 볼 수는 있다.

![image](https://user-images.githubusercontent.com/89781598/193574411-b44a5017-2ff8-4cf8-8727-ad533edce1d1.png)

왼쪽그림에서, 나쁜 지렛대 점은 197, 198, 200번 관측치로 측정되고, 오른쪽에서 원의 크기를 보았을 때, 11, 15, 197, 198, 208, 212번째 관측값에 대한 쿡의 거리값이 가장 크다. 즉, 쿡의 거리가 크면 이상치일 가능성이 있다는 의미이다.

## 결론
모든 측도들을 종합하면 아래와 같다.

![image](https://user-images.githubusercontent.com/89781598/193574478-8b5d3a97-72f8-4cb2-9820-307f4bfd2fb5.png)

이 때, 위의 측도들에서 2번 이상 이상치라고 판정 받은 관측치들만 제외시킨다. 이 값은 2, 3, 9, 11, 13, 14, 15, 48, 59, 155, 158, 170, 191, 194, 195, 197, 198, 200, 203, 204, 205, 208, 209, 211, 212이다.


